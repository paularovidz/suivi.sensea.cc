---
import SEO from "@/components/seo/Seo.astro";
import Font from "@/components/widgets/Font.astro";
import OpenGraph from "@/components/seo/OpenGraph.astro";
import Favicons from "@/components/seo/Favicons.astro";
import LCPPreload from "@/components/seo/LCPPreload.astro";
import parseTomlToJson from "@/lib/utils/parseTomlToJson.ts";
import theme from "@/config/theme.json";
import JsonLD from "../widgets/JsonLD.astro";

const config = parseTomlToJson("./src/config/config.toml");
const themeColor = theme.colors.default.theme_color.primary;
---

<head>
  <!------------
    General
-------------->
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Language" content={Astro.currentLocale} />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
  <LCPPreload image={Astro.props.image} preloadLCP={Astro.props.preloadLCP} />
  <link rel="preconnect" href="https://plausible.io">
  <link rel="preconnect" href="https://embed.typeform.com">
  <SEO {...Astro.props} />
  
  <meta
    name="theme-color"
    media="(prefers-color-scheme: light)"
    content={themeColor || "#fff"}
  />
  <meta
    name="theme-color"
    media="(prefers-color-scheme: dark)"
    content="#000"
  />
  <script data-domain="sensea.cc" src="https://plausible.io/js/script.js" defer></script>
  <script>
    window.addEventListener('message', function (event) {
        if (event.data.type === 'form-submit' && sessionStorage.getItem("Contact") !== "1") {
            sessionStorage.setItem("Contact", "1");
            plausible('Contact');
        }
        else if (event.data.type === 'form-ready') {
            plausible('Ouverture formulaire contact');
        }
    }, false);
  </script>
  
  <!-- Script pour liens obfusquÃ©s -->
  <script src="/js/links-client.js" defer></script>
  <OpenGraph {...Astro.props} />
  <Favicons />
  <JsonLD
    content={{
      ...Astro.props,
    }}
  />

  <Font />
</head>
